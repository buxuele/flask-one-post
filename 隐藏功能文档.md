# Echo - 隐藏功能文档

本文档记录了 Echo 项目中已实现但当前隐藏的功能。这些功能代码完整保留，仅通过 HTML 注释隐藏了 UI 元素，可随时重新启用。

---

## 1. 发布前自检面板 (quality-panel)

### 功能描述
- 可拖拽的悬浮面板，位于编辑器左侧
- 显示4条内容质量检查提示
- 深色毛玻璃风格，支持鼠标拖拽移动位置

### 检查项
1. 是否在讲道理，而非发泄情绪
2. 是否对他人有实际帮助
3. 内容是否有实际意义
4. 能否帮助别人节省时间

### 代码位置
- **HTML**: `templates/index.html` 第 772-786 行（已注释）
- **CSS**: `.quality-panel`, `.quality-panel-header`, `.quality-tips-list`, `.quality-tip` 等
- **JS**: 拖拽功能代码（保留在原有位置）

### 启用方法
取消注释 `templates/index.html` 中对应代码块：
```html
<div class="quality-panel" id="qualityPanel">
    ...
</div>
```

---

## 2. 草稿箱面板 (draft-panel)

### 功能描述
- 右侧面板，显示本地存储的所有草稿
- 支持多草稿管理：创建、切换、删除
- 自动保存：输入后2秒自动保存到 localStorage
- 显示草稿内容预览和最后更新时间

### 主要功能
- **新建草稿**: 点击"新建"按钮创建空白草稿
- **切换草稿**: 点击草稿项加载内容
- **自动保存**: 内容变更后自动保存
- **删除草稿**: 悬停显示删除按钮

### 代码位置
- **HTML**: `templates/index.html` 第 788-796 行（已注释）
- **CSS**: `.draft-panel`, `.draft-item`, `.draft-new-btn` 等
- **JS**: 
  - 草稿管理函数：`getDrafts()`, `saveDrafts()`, `createNewDraft()`, `loadDraft()`, `saveCurrentDraft()`
  - 事件监听：自动保存、新建按钮、删除功能

### 数据结构
```javascript
{
    id: "timestamp",
    content: "草稿内容",
    images: [],
    updatedAt: "ISO时间字符串"
}
```

### 启用方法
取消注释 `templates/index.html` 中对应代码块：
```html
<div class="draft-panel" id="draftPanel">
    ...
</div>
```

---

## 3. 发布预览功能 (preview-modal)

### 功能描述
- 模态框展示发布后的卡片效果
- 支持切换 X (Twitter) 和知乎两种预览样式
- 检查字符限制（X 限制 280 字符）
- 显示图片预览

### 主要功能
- **平台切换**: 点击标签切换 X/知乎预览
- **字符警告**: 超出限制时显示警告提示
- **图片展示**: 网格布局显示所有上传图片
- **关闭方式**: 点击关闭按钮或遮罩层

### 代码位置
- **HTML**: `templates/index.html` 第 858-887 行（已注释）
- **CSS**: `.preview-modal`, `.preview-card`, `.preview-tab` 等
- **JS**: 
  - 事件监听：`previewBtn`, `previewClose`, `previewTabs`
  - 更新函数：根据内容和图片更新预览

### 快捷键
- `Ctrl/Cmd + P`: 打开预览

### 启用方法
1. 取消注释预览按钮（第 834-839 行）
2. 取消注释预览模态框（第 858-887 行）
3. 取消注释键盘快捷键提示中的预览部分

---

## 4. 定时发布功能 (schedule-modal)

### 功能描述
- 设置未来时间自动发布内容
- 后台调度器每30秒检查一次待发布任务
- 独立的排期列表页面管理所有任务
- 支持取消待发布的任务

### 主要功能
- **创建排期**: 选择日期时间创建定时发布
- **状态管理**: pending(待发布) / published(已发布) / failed(失败) / cancelled(已取消)
- **自动执行**: 后台线程自动执行到期的发布任务
- **历史同步**: 发布后自动添加到历史记录

### 代码位置
- **HTML**:
  - 按钮：`templates/index.html` 第 840-845 行（已注释）
  - 模态框：`templates/index.html` 第 889-910 行（已注释）
- **CSS**: 复用 `.preview-modal` 样式
- **JS**: `templates/index.html` 中的定时发布相关代码
- **后端**:
  - 模型：`models.py` - `ScheduledPost` 类
  - API：`app.py` - `/api/scheduled` 相关路由
  - 调度器：`app.py` - `run_scheduler()` 函数
- **页面**: `templates/scheduled.html` - 排期列表页面

### 数据库表
```sql
scheduled_post:
- id: 主键
- content: 内容
- platforms: 平台（逗号分隔）
- image_paths: 图片路径（逗号分隔）
- scheduled_at: 计划发布时间
- status: 状态
- created_at: 创建时间
- published_at: 实际发布时间
- error_message: 错误信息
```

### 启用方法
1. 取消注释定时发布按钮（第 840-845 行）
2. 取消注释定时发布模态框（第 889-910 行）
3. 取消注释导航栏中的排期链接（`base.html`）

---

## 5. 键盘快捷键提示 (shortcuts-hint)

### 功能描述
- 页面右下角显示快捷键提示
- 美观的键盘样式展示
- 半透明背景，不遮挡主要内容

### 快捷键列表
- `Ctrl/Cmd + Enter`: 立即发布
- `Ctrl/Cmd + S`: 保存草稿
- `Ctrl/Cmd + L`: AI 润色
- `Ctrl/Cmd + P`: 打开预览

### 代码位置
- **HTML**: `templates/index.html` 第 912-914 行（已注释）
- **CSS**: `.shortcuts-hint`, `.shortcuts-hint kbd`
- **JS**: 键盘事件监听代码（保留）

### 启用方法
取消注释 `templates/index.html` 中对应代码：
```html
<div class="shortcuts-hint">
    <kbd>Ctrl</kbd>+<kbd>Enter</kbd> 发布 · <kbd>Ctrl</kbd>+<kbd>S</kbd> 保存 · ...
</div>
```

---

## 快速启用所有隐藏功能

如需一键启用所有功能，可以：

1. 打开 `templates/index.html`
2. 搜索 "功能已隐藏" 注释
3. 取消对应代码块的注释

或创建启用脚本自动处理。

---

## 注意事项

1. **代码完整性**: 所有功能的 JavaScript 代码都完整保留，仅隐藏了 UI
2. **数据持久化**: 草稿功能使用 localStorage，不受 UI 隐藏影响
3. **后台任务**: 定时发布的后台调度器仍在运行（如需完全禁用需注释 `app.py` 中的调度器启动代码）
4. **API 可用性**: 所有后端 API 仍然可用，可直接访问

---

## 更新记录

- **2026-02-11**: 创建本文档，记录已实现的隐藏功能
