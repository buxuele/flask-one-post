{% extends "base.html" %}

{% block title %}Echo - 社交发布助手{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/index.css') }}?v=2">
{% endblock %}

{% block content %}

<div class="container">
    <div class="editor-area">
        <div class="editor-wrapper">
            <textarea id="contentInput" placeholder="在此输入您的内容..."></textarea>
            <div class="char-counter" id="charCounter">0/140</div>
        </div>
    </div>
    
    <div class="image-preview-area">
        <div class="image-grid" id="imageGrid">
            {% for img in images %}
            <div class="image-item" data-id="{{ img.id }}" data-index="{{ loop.index0 }}" draggable="true">
                <div class="drag-handle">
                    <span class="icon" style="width: 12px; height: 12px;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" fill="currentColor"/></svg>
                    </span>
                </div>
                <img src="{{ img.url }}" alt="Preview" draggable="false">
                <button class="remove-btn" onclick="event.stopPropagation(); removeImage('{{ img.id }}')">
                    <span class="icon" style="width: 10px; height: 10px;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" fill="currentColor"/></svg>
                    </span>
                </button>
            </div>
            {% endfor %}
        </div>
    </div>
    
    <div class="footer-toolbar">
        <div class="toolbar-content">
            <div class="toolbar-left">
                <input type="file" id="fileInput" class="hidden" accept="image/*" multiple>
                <button class="btn btn-outline" onclick="document.getElementById('fileInput').click()">
                    <span class="icon" style="width: 16px; height: 16px;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z" fill="currentColor"/></svg>
                    </span>
                    <span>添加图片</span>
                </button>

                <button class="btn btn-outline" id="refineBtn" title="添加标签">
                    <span class="icon" id="refineIcon" style="width: 16px; height: 16px;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.41 11.58l-9-9C12.05 2.22 11.55 2 11 2H4c-1.1 0-2 .9-2 2v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58.55 0 1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.55-.23-1.06-.59-1.42zM5.5 7C4.67 7 4 6.33 4 5.5S4.67 4 5.5 4 7 4.67 7 5.5 6.33 7 5.5 7z" fill="currentColor"/></svg>
                    </span>
                    <span>添加标签</span>
                </button>

                <div class="platform-select" id="platformSelect">
                    <button class="platform-btn active" data-platform="twitter" title="X">
                        <span class="platform-icon" style="width: 16px; height: 16px;">
                            <svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
                        </span>
                    </button>
                    <button class="platform-btn active" data-platform="zhihu" title="知乎">
                        <span style="font-size: 12px; font-weight: 600;">知乎</span>
                    </button>
                </div>
            </div>
            
            <!-- 功能已隐藏：预览按钮 (previewBtn) -->
            <!-- 功能已隐藏：定时发布按钮 (scheduleBtn) -->
            <button class="btn btn-primary" id="publishBtn">
                <span>立即发布</span>
            </button>
        </div>
    </div>
</div>

<div class="toast" id="toast"></div>
{% endblock %}

{% block extra_js %}
<script>
    window.INITIAL_IMAGES = {{ images | tojson }};
</script>
<script src="{{ url_for('static', filename='js/index.js') }}?v=3"></script>
{% endblock %}
